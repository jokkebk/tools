<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
<meta name="description" content="Practice piano notes for both hands">
<meta name="keywords" content="piano,bass,treble,clef,notes,trainer">
<meta name="author" content="Joonas Pihlajamaa">
<title>Piano Trainer</title>

<style type="text/css">
* { box-sizing: border-box; }
html, body {
  margin: 0;
  padding: 0;
  overflow: hidden;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
}

#controls {
  position: fixed;
  bottom: 10px;
  left: 50%;
  transform: translateX(-50%);
  z-index: 10;
  background: rgba(255, 255, 255, 0.95);
  padding: 8px 12px;
  border-radius: 20px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.2);
}

.hand-btn {
  padding: 8px 16px;
  border: 2px solid #333;
  background: white;
  cursor: pointer;
  font-size: 14px;
  transition: all 0.2s;
  touch-action: manipulation;
}

.hand-btn:first-child {
  border-radius: 12px 0 0 12px;
  border-right: 1px solid #333;
}

.hand-btn:last-child {
  border-radius: 0 12px 12px 0;
  border-left: 1px solid #333;
}

.hand-btn.active {
  background: #333;
  color: white;
}

.hand-btn:active {
  transform: scale(0.95);
}

svg {
  position: fixed;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
  touch-action: none;
}
</style>
</head>
<body>

<div id="controls">
  <button class="hand-btn active" data-hand="left">Left Hand (Bass)</button>
  <button class="hand-btn" data-hand="right">Right Hand (Treble)</button>
</div>

<svg id="piano" viewBox="0 0 400 200">
  <rect x="20" y="32" width="360" height="48" stroke="black" fill="none" />
  <line x1="20" y1="44" x2="380" y2="44" stroke="black" />
  <line x1="20" y1="56" x2="380" y2="56" stroke="black" />
  <line x1="20" y1="68" x2="380" y2="68" stroke="black" />

  <!-- Bass clef (F clef) - original: width="40" height="40" for 18x20 SVG -->
  <g id="bassClef" display="none">
    <g transform="translate(20, 32) scale(2.222, 2)">
      <g transform="translate(6.600000e-3,3.125356e-3)">
        <g transform="translate(-230.9546,-533.6597)" style="fill:#000000;fill-opacity:1.0">
          <path d="M 248.25999,536.80200 C 248.26766,537.17138 248.11044,537.54065 247.82878,537.78185 C 247.46853,538.11076 246.91933,538.17813 246.47048,538.01071 C 246.02563,537.83894 245.69678,537.39883 245.67145,536.92060 C 245.63767,536.54689 245.75685,536.15479 246.02747,535.88867 C 246.28257,535.61680 246.66244,535.48397 247.03147,535.50645 C 247.41131,535.51452 247.77805,535.70601 248.00489,536.01019 C 248.17962,536.23452 248.26238,536.51954 248.25999,536.80200 z " />
        </g>
        <g transform="translate(-230.9546,-533.6597)" style="fill:#000000;fill-opacity:1.0">
          <path d="M 248.25999,542.64502 C 248.26772,543.01469 248.11076,543.38446 247.82878,543.62585 C 247.46853,543.95476 246.91933,544.02213 246.47048,543.85472 C 246.02537,543.68288 245.69655,543.24237 245.67145,542.76389 C 245.63651,542.38990 245.76354,542.00308 246.02700,541.73300 C 246.27663,541.45454 246.66060,541.32790 247.02845,541.34950 C 247.51230,541.36282 247.95159,541.69251 248.15162,542.12465 C 248.22565,542.28740 248.26043,542.46657 248.25999,542.64502 z " />
        </g>
        <g transform="translate(-230.9546,-533.6597)" style="fill:#000000;fill-opacity:1.0">
          <path d="M 243.97900,540.86798 C 244.02398,543.69258 242.76360,546.43815 240.76469,548.40449 C 238.27527,550.89277 235.01791,552.47534 231.69762,553.53261 C 231.25590,553.77182 230.58970,553.45643 231.28550,553.13144 C 232.62346,552.52289 234.01319,552.00050 235.24564,551.18080 C 237.96799,549.49750 240.26523,546.84674 240.82279,543.61854 C 241.14771,541.65352 241.05724,539.60795 240.56484,537.67852 C 240.20352,536.25993 239.22033,534.79550 237.66352,534.58587 C 236.25068,534.36961 234.74885,534.85905 233.74057,535.88093 C 233.47541,536.14967 232.95916,536.89403 233.04435,537.74747 C 233.64637,537.27468 233.60528,537.32732 234.09900,537.10717 C 235.23573,536.60031 236.74349,537.32105 237.02700,538.57272 C 237.32909,539.72295 237.09551,541.18638 235.96036,541.79960 C 234.77512,542.44413 233.02612,542.17738 232.36450,540.90866 C 231.26916,538.95418 231.87147,536.28193 233.64202,534.92571 C 235.44514,533.42924 238.07609,533.37089 240.19963,534.13862 C 242.38419,534.95111 243.68629,537.21483 243.89691,539.45694 C 243.95419,539.92492 243.97896,540.39668 243.97900,540.86798 z " />
        </g>
      </g>
    </g>
  </g>

  <!-- Treble clef (G clef) - original: width="20" height="55" for 15.186x40.768 SVG -->
  <g id="trebleClef" display="none">
    <g transform="translate(20, 32) scale(1.317, 1.349)">
      <path d="m12.049 3.5296c0.305 3.1263-2.019 5.6563-4.0772 7.7014-0.9349 0.897-0.155 0.148-0.6437 0.594-0.1022-0.479-0.2986-1.731-0.2802-2.11 0.1304-2.6939 2.3198-6.5875 4.2381-8.0236 0.309 0.5767 0.563 0.6231 0.763 1.8382zm0.651 16.142c-1.232-0.906-2.85-1.144-4.3336-0.885-0.1913-1.255-0.3827-2.51-0.574-3.764 2.3506-2.329 4.9066-5.0322 5.0406-8.5394 0.059-2.232-0.276-4.6714-1.678-6.4836-1.7004 0.12823-2.8995 2.156-3.8019 3.4165-1.4889 2.6705-1.1414 5.9169-0.57 8.7965-0.8094 0.952-1.9296 1.743-2.7274 2.734-2.3561 2.308-4.4085 5.43-4.0046 8.878 0.18332 3.334 2.5894 6.434 5.8702 7.227 1.2457 0.315 2.5639 0.346 3.8241 0.099 0.2199 2.25 1.0266 4.629 0.0925 6.813-0.7007 1.598-2.7875 3.004-4.3325 2.192-0.5994-0.316-0.1137-0.051-0.478-0.252 1.0698-0.257 1.9996-1.036 2.26-1.565 0.8378-1.464-0.3998-3.639-2.1554-3.358-2.262 0.046-3.1904 3.14-1.7356 4.685 1.3468 1.52 3.833 1.312 5.4301 0.318 1.8125-1.18 2.0395-3.544 1.8325-5.562-0.07-0.678-0.403-2.67-0.444-3.387 0.697-0.249 0.209-0.059 1.193-0.449 2.66-1.053 4.357-4.259 3.594-7.122-0.318-1.469-1.044-2.914-2.302-3.792zm0.561 5.757c0.214 1.991-1.053 4.321-3.079 4.96-0.136-0.795-0.172-1.011-0.2626-1.475-0.4822-2.46-0.744-4.987-1.116-7.481 1.6246-0.168 3.4576 0.543 4.0226 2.184 0.244 0.577 0.343 1.197 0.435 1.812zm-5.1486 5.196c-2.5441 0.141-4.9995-1.595-5.6343-4.081-0.749-2.153-0.5283-4.63 0.8207-6.504 1.1151-1.702 2.6065-3.105 4.0286-4.543 0.183 1.127 0.366 2.254 0.549 3.382-2.9906 0.782-5.0046 4.725-3.215 7.451 0.5324 0.764 1.9765 2.223 2.7655 1.634-1.102-0.683-2.0033-1.859-1.8095-3.227-0.0821-1.282 1.3699-2.911 2.6513-3.198 0.4384 2.869 0.9413 6.073 1.3797 8.943-0.5054 0.1-1.0211 0.143-1.536 0.143z" fill="#000000" />
    </g>
  </g>

  <g id="notes"></g>
  <g id="keyboard"></g>
</svg>

<script type="text/javascript">
var svg = document.getElementById('piano');
var pt = svg.createSVGPoint();
var noteList = [], nextNote = 0;
var timer = false;
var currentHand = 'left';

var configs = {
  left: {
    keyw: 22, blackw: 12, keys: 17,
    blackSkip: [2, 6],
    playOffset: 0,
    randomRange: 17
  },
  right: {
    keyw: 20, blackw: 12, keys: 19,
    blackSkip: [3, 6],
    playOffset: -2,
    randomRange: 18
  }
};

var kb = {
  xoff: 13, yoff: 115, keyh: 82
};

var keys = [];

function svgCoord(evt) {
  var clientX = evt.clientX !== undefined ? evt.clientX : evt.touches[0].clientX;
  var clientY = evt.clientY !== undefined ? evt.clientY : evt.touches[0].clientY;
  pt.x = clientX;
  pt.y = clientY;
  return pt.matrixTransform(svg.getScreenCTM().inverse());
}

function playNote(note, black) {
  if(black) return;

  if(nextNote < 8) {
    appendNote(document.getElementById('notes'), note, nextNote,
        note == noteList[nextNote] ? 'green' : 'red');
    nextNote++;
  }

  if(nextNote >= 8 && timer === false) {
    timer = setTimeout(function() {
      generateNotes();
      nextNote = 0;
      timer = false;
    }, 1500);
  }
}

function appendNote(notes, note, i, color) {
  var x = 70 + 40*i;

  for(var j=note-1; j<4; j++) {
    var ly = 104-6*j;
    if(j & 1) continue;
    notes.appendChild(makeSvg('line', {
      y1: ly, y2: ly, x1: x-9, x2: x+9,
      stroke: color
    }));
  }

  for(var j=note; j>=14; j--) {
    var ly = 104-6*j;
    if(j & 1) continue;
    notes.appendChild(makeSvg('line', {
      y1: ly, y2: ly, x1: x-9, x2: x+9,
      stroke: color
    }));
  }

  notes.appendChild(makeSvg('line', {
    x1: x+5.5, x2: x+5.5,
    y1: 104-6*note,
    y2: 104-6*note + (note < 8 ? -36 : 36),
    stroke: color
  }));

  notes.appendChild(makeSvg('circle', {
    cx: x, cy: 104-6*note, r: 6,
    stroke: 'none', fill: color
  }));
}

function makeSvg(name, attrs) {
  var elem = document.createElementNS('http://www.w3.org/2000/svg', name);
  for(var key in attrs)
    if(attrs.hasOwnProperty(key))
      elem.setAttribute(key, attrs[key]);
  return elem;
}

function drawKeyboard(elem) {
  var config = configs[currentHand];
  keys = [];

  while(elem.lastChild) elem.removeChild(elem.lastChild);

  for(var i=0; i<config.keys; i++) {
    keys.push({
      x: (i*config.keyw + kb.xoff), y: kb.yoff,
      width: config.keyw, height: kb.keyh,
      stroke: 'black', fill: 'white'
    });
  }

  for(var i=0; i<config.keys; i++) {
    if(config.blackSkip.indexOf(i % 7) !== -1) continue;
    var width = (currentHand === 'right' && i+1 === config.keys) ?
      config.blackw/2 : config.blackw;
    keys.push({
      x: (i*config.keyw + kb.xoff + config.keyw/2 + ((config.keyw-config.blackw)/2)),
      y: kb.yoff,
      width: width, height: kb.keyh/2,
      stroke: 'black', fill: 'black'
    });
  }

  keys.forEach(function(key) {
    elem.appendChild(makeSvg('rect', key));
  });
}

function generateNotes() {
  var config = configs[currentHand];
  var notes = document.getElementById('notes');

  while(notes.lastChild) notes.removeChild(notes.lastChild);

  noteList = [];
  while(noteList.length < 8) {
    var note = Math.floor(Math.random()*config.randomRange);
    if((note < 3 || note > 12) && Math.random() > 0.5) continue;
    appendNote(notes, note, noteList.length, 'black');
    noteList.push(note);
  }
}

function switchHand(hand) {
  currentHand = hand;

  document.getElementById('bassClef').style.display = hand === 'left' ? 'block' : 'none';
  document.getElementById('trebleClef').style.display = hand === 'right' ? 'block' : 'none';

  document.querySelectorAll('.hand-btn').forEach(function(btn) {
    btn.classList.toggle('active', btn.dataset.hand === hand);
  });

  drawKeyboard(document.getElementById('keyboard'));
  generateNotes();
  nextNote = 0;
  if(timer) {
    clearTimeout(timer);
    timer = false;
  }
}

function handleInput(evt) {
  evt.preventDefault();
  var c = svgCoord(evt);

  for(var i=keys.length-1; i>=0; i--) {
    var key = keys[i];
    if(key.x <= c.x && c.x <= key.x + key.width &&
      key.y <= c.y && c.y <= key.y + key.height) {
      if(key.fill == 'black') return;
      var config = configs[currentHand];
      playNote(i + config.playOffset, false);
      break;
    }
  }
}

// Initialize
switchHand('left');

// Event listeners
document.querySelectorAll('.hand-btn').forEach(function(btn) {
  btn.addEventListener('click', function() {
    switchHand(this.dataset.hand);
  });
});

svg.addEventListener('click', handleInput);
svg.addEventListener('touchstart', handleInput);
</script>

</body>
</html>
